<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <title>Brewmiester Production</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!--<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
            integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
            crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="../../Scripts/ajaxCalls.js"></script>



    <script>

        // TODO
        // need to change fromat() function, so it will render to a row the data from Invenory that relates to that row

        $(document).ready(function () {

            ajaxCall("GET", "../../api/Product", "", GetProductSucess, GetProductError); // get all products


            // DT events for Plus btn
            $('#tbl').on('click', 'td.details-control', function () {

                var tr = $(this).closest('tr');
                var row = $('#tbl').DataTable().row(tr);

                if (row.child.isShown()) {
                    // This row is already open - close it
                    row.child.hide();
                    tr.removeClass('shown');
                }
                else {
                    // Open this row
                    row.child(format(row.data())).show();

                    //$(row.child()).DataTable();

                    tr.addClass('shown');
                }
            });
            // ** DT events for Plus btn
        });

        function format(d) {
            // `d` is the original data object for the row
            return `<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">' 
                <tr>
                <td>Full name:</td>
                <td> blabla </td>
                </tr>
                <tr>
                <td>Extension number:</td>
                <td>blabla</td>
                </tr>
                <tr>
                <td>Extra info:</td>
                <td>And any further details here (images etc)...</td>
                </tr>
                </table>`;
        }


        // Invenotry API
        function GetProductSucess(Product_data) {

            console.log('this is product data:', Product_data);


            try {
                $('#tbl').DataTable({

                    data: Product_data,
                    pageLength: 5,
                    columns: [             
                        {
                            "className": 'details-control',
                            "orderable": false,
                            "data": null,
                            "defaultContent": ''
                        },
                        { data: "ProductName" },  
                        {
                            data: "Amount"
                        }, 
                        { data: "Last_arrivalTime" },
                        {
                            data: "Min_amount"
                        }
                    ]
                });
            }

            catch (err) {
                alert(err);
            }

           
        }

        function GetProductError(err) {
            console.log(err);
        }
        // ** Product API

        
    </script>



    <style>
        body {
            background-color: #f7f6f6;
            padding-bottom: 1%;
        }

        #headerRow {
            height: 180px;
        }

        .navbar {
            height: 70px;
        }

        table {
            text-align: center;
        }
        #addprod {
            text-align: center;
            margin-top: 100px;
            margin: auto;
            width: 60%;
            border: solid 2px;
            background-color: aliceblue;
        }

        .container {
            padding-bottom: 4%;
        }

        td.details-control {
            background: url('../Images/details_open.png') no-repeat center center;
            cursor: pointer;
        }

        tr.shown td.details-control {
            background: url('../Images/details_close.png') no-repeat center center;
        }
    </style>

</head>

<body>
    <!-- NavBar Template -->
    <div class="header text-center">
        <nav class="navbar navbar-expand-lg navbar-light border-bottom" style="background-color: #f7f6f6;">
            <a class="navbar-brand" href="Brewmiester-dashboard.html">Home</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item active">
                        <a class="nav-link" href="Brewmiester-prod.html">Production</a>
                    </li>
                    <li class="nav-item active px-2">
                        <a class="nav-link" href="Inventory.html">Inventory</a>
                    </li>
                    <li class="nav-item active px-2">
                        <a class="nav-link" href="#">Waste</a>
                    </li>
                    <li class="nav-item active px-2">
                        <a class="nav-link" href="Alerts.html">Alerts</a>
                    </li>
                    <!-- <li class="nav-item">
                      <a class="nav-link disabled" href="#">Disabled</a>
                    </li> -->
                </ul>
            </div>
            <a class="navbar-brand" href="#">
                <img src="../Images/Logo_alexander.jpeg" height="68" alt="alexander logo">
            </a>
        </nav>
    </div>
    <br>
    <!-- NavBar Template -->
    <!-- table -->
    <div class="container">
        <table id="tbl" class="display" border="1" style="width:100%">
            <thead style="background-color:cornflowerblue">
                <tr>
                    <th></th> <!--edit/delete buttons-->
                    <th>Type</th>
                    <th>Amount</th>
                    <th>Last Arrival Date</th>
                    <th>Minimum Amount</th>
                </tr>
            </thead>
            <tbody>
            </tbody>

        </table>

        <button id="add_new_cook" data-toggle='collapse' data-target='#addprodContainer' aria-expanded='false' aria-controls='addprodContainer'>Add</button>
        <!-- collapse/Expend the addprodcontianer (bootstrap) data-toggle='collapse' data-target='#addprodContainer' aria-expanded='false' aria-controls='addprodContainer' -->

    </div>
    <!-- table -->
    <!-- Add Product -->
    <div class="container collapse" id="addprodContainer">
        <div id="addprod">
            <br />
            <form id="ourForm">
                <select name="Beer" id="beerSelect"></select>
                <br><br>
                <label>Choose date</label>
                <input type="date" name="date" id="addDate">
                <br><br>

                <div id="inForm"></div>

                <button id="addToBatch" type="submit">Submit</button>
                <br /><br />
            </form>
        </div>
    </div>
    <!-- Add Product -->
    <!--Edit Row In  Table-->
    <div class="container" id="editDiv">
        <form id="editForm">
            <div class="form-group">
                <label for="">Beer Type</label>
                <input type="text" class="form-control" id="beerTypeInput" required />
                <br />
                <label for="fromDate">Date</label>
                <input type="date" class="form-control" id="batchDateInput" required />
            </div>
            <button id="submit_edit">Submit</button>
        </form>
    </div>
    <!--Edit Row In  Table-->

    <div id="ph"></div>
</body>

</html>